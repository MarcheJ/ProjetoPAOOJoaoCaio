<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Busca Emprego PAOO - Home</title>
  <link rel="stylesheet" href="/buscaEmpregoPAOO/api/css/curriculum.css">
</head>
<body>
  <h1>Busca Emprego - PII</h1>
  <nav id="mainNav">
  </nav>
  <div style="margin: 10px 0;" id="mainButtons">
  </div>
  <ul id="vacanciesList"></ul>
  <p>Bem-vindo(a) ao jobfinder Orientado a Objetos!</p>

  <script>
    function isLoggedIn() {
      return !!localStorage.getItem('candidateId');
    }

    function renderMenu() {
      const nav = document.getElementById('mainNav');
      const btns = document.getElementById('mainButtons');
      nav.innerHTML = '';
      btns.innerHTML = '';

      if (isLoggedIn()) {
        nav.innerHTML = `
          <a href="/buscaEmpregoPAOO/api/vacancies.html">Vagas</a> |
          <a href="/buscaEmpregoPAOO/api/companies.html">Empresas</a> |
          <a href="/buscaEmpregoPAOO/api/candidates.html">Minha Conta</a> |
          <a href="/buscaEmpregoPAOO/api/applications.html">Candidaturas</a> |
          <a href="/buscaEmpregoPAOO/api/curriculum.html">Currículo</a>
        `;
        btns.innerHTML = `
          <button onclick="location.href='/buscaEmpregoPAOO/api/vacancies.html'">Vagas</button>
          <button onclick="location.href='/buscaEmpregoPAOO/api/companies.html'">Empresas</button>
          <button onclick="location.href='/buscaEmpregoPAOO/api/candidates.html'">Minha Conta</button>
          <button onclick="location.href='/buscaEmpregoPAOO/api/applications.html'">Candidaturas</button>
          <button onclick="location.href='/buscaEmpregoPAOO/api/curriculum.html'">Currículo</button>
        `;
      } else {
        nav.innerHTML = `
          <a href="/buscaEmpregoPAOO/api/vacancies.html">Vagas</a> |
          <a href="/buscaEmpregoPAOO/api/companies.html">Empresas</a> |
          <a href="/buscaEmpregoPAOO/api/curriculum.html">Currículo</a> |
          <a href="/buscaEmpregoPAOO/api/candidates.html">Login</a> |
          <a href="/buscaEmpregoPAOO/api/candidates.html#create">Criar Conta</a>
        `;
        btns.innerHTML = `
          <button onclick="location.href='/buscaEmpregoPAOO/api/vacancies.html'">Vagas</button>
          <button onclick="location.href='/buscaEmpregoPAOO/api/companies.html'">Empresas</button>
          <button onclick="location.href='/buscaEmpregoPAOO/api/curriculum.html'">Currículo</button>
          <button onclick="location.href='/buscaEmpregoPAOO/api/candidates.html'">Login</button>
          <button onclick="location.href='/buscaEmpregoPAOO/api/candidates.html#create'">Criar Conta</button>
        `;
      }
    }

    renderMenu();

    fetch('/buscaEmpregoPAOO/api/vacancies')
      .then(response => response.json())
      .then(data => {
        const list = document.getElementById('vacanciesList');
        data.forEach(vacancy => {
          const li = document.createElement('li');
          li.textContent = vacancy.title + ' - ' + vacancy.location;
          list.appendChild(li);
        });
      })
      .catch(err => console.error('Erro ao buscar vagas', err));
  </script>
</body>
</html>
